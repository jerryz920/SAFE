{
  "name": "CodeQuality",
  "envs": {
    "ScannerSource": "\"https://github.com/arminc/clair-scanner.git#master\""
  },
  "comment-trustwallet": "it defines additional trusts besides those from endorsers",
  "trustWallet": [
    "fatalCVE(\"cve-2017-8834\")",
    "fatalCVE(\"cve-2017-7691\")",
    "fatalCVE(\"cve-2017-7960\")",
    "scannerSource($ScannerSource)"
  ],
  "rules": [
    [
      "checkVulnerability(Instance)",
      "\\+(vulnerable(Instance))"
    ],
    [
      "vulnerable(Instance)",
      "launches(Instance, Image)",
      "buildsFrom(Image, Source)",
      "Scanner: endorse(Source, \"cve\", Cve)",
      "fatalCVE(Cve)",
      "clairScanner(Scanner)"
    ],
    [
      "clairScanner(Instance)",
      "launches(Instance, Image)",
      "buildsFrom(Image, Source)",
      "scannerSource(Source)"
    ]
  ],

  "comment-guards": "These are guard interfaces",
  "guards": {
    "CodeQuality": {
      "args": ["?Instance"],
      "exprs": [
	["?InstanceSet", ":=", "label($BearerRef, \"instance/?Instance\")"],
	["?HostSet", ":=", "label(?Instance, \"instance/?Instance\")"]
      ],
      "links": [
	"$InstanceSet",
	"$HostSet"
      ],
      "queries": [
	"checkVulnerability($Instance)"
      ]
    }
  }
}
